{"ast":null,"code":"var _jsxFileName = \"/Users/otnielvictoryfa/task2020/atur-tagihan/pages/detail-tagihan/[order_id]/index.js\";\nvar __jsx = React.createElement;\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport Router from 'next/router'; // material\n\nimport CircularProgress from '@material-ui/core/CircularProgress'; // component\n\nimport MainLogo from '../../../components/global-component/MainLogo';\nimport { getHashUrl } from '../../../utils/CommonUtils';\nimport ButtonMain from '../../../components/global-component/ButtonMain'; // redux\n\nimport { isNotUndefined } from '../../../utils/Validator';\nimport { isUserLoggedValid } from '../../../utils/NetworkCall';\nimport CustomDialog from '../../../components/global-component/CustomDialog';\nexport class DetailTagihan extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true\n    };\n  }\n\n  async componentDidMount() {\n    document.body.className = 'body-blue';\n    const orderId = getHashUrl();\n    this.setState({\n      login: await isUserLoggedValid()\n    });\n\n    if (this.state.login === 'logged') {\n      this.inquiry(orderId);\n    }\n  }\n\n  componentWillUnmount() {\n    document.body.className = null;\n  }\n  /**\n   * @method Inquiry\n   * @summary do inquiry of bayartagihan product\n   * @param hash\n   * @returns {Promise<void>}\n   * @note gak pake helper karena banyak kondisi\n   */\n\n\n  async inquiry(hash) {\n    const {\n      showSnackbar\n    } = this.props;\n    const BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL;\n    const url = `${BASE_URL}/inquiry/atur_tagihan`;\n    const headers = {\n      'Content-Type': 'application/json',\n      Authorization: `Bearer ${JSON.parse(localStorage.getItem('token')).access_token}`\n    };\n    const data = JSON.stringify({\n      order_identifier: hash\n    });\n    await axios.post(url, data, {\n      headers\n    }).then(async apiResponse => {\n      const {\n        response,\n        result\n      } = apiResponse.data;\n\n      if (response.code !== '000000') {\n        showSnackbar('Terjadi Gangguan', 'error');\n        this.setState({\n          isLoading: false\n        });\n      } else if (result.is_processed === 1) {\n        Router.push(`/status-pembayaran/${hash}`);\n        this.setState({\n          isLoading: false\n        });\n      } else {\n        this.history.replaceState({}, document.title, url);\n        this.props.router.replace('/keranjang'); //Router.push('/keranjang');\n      }\n    }).catch(error => {\n      if (isNotUndefined(error.response)) {\n        const {\n          data\n        } = error.response;\n\n        if (data.response.code === '000007') {\n          Router.push('/url-not-found');\n        } // payment by b2b\n        else if (data.response.code === '000008') {\n            Router.push('/pembayaran-berhasil');\n          } else if (data.response.code === '000009') {\n            Router.push('/expired-bill');\n          }\n\n        showSnackbar(data.response.user_errors, 'error');\n      } else {\n        showSnackbar(error.toString(), 'error');\n      }\n\n      this.setState({\n        isLoading: false\n      });\n    });\n  }\n\n  render() {\n    const {\n      isLoading,\n      login\n    } = this.state;\n    let dialogLogin;\n\n    if (login === 'empty' || login === 'expired' || login === 'inactive') {\n      let title;\n\n      switch (login) {\n        case 'expired':\n          title = 'Sesi Anda Telah Habis';\n          break;\n\n        case 'inactive':\n          title = 'Akun Anda Tidak Aktif atau Terblokir';\n          break;\n\n        default:\n          title = 'Pemberitahuan';\n      }\n\n      dialogLogin = __jsx(CustomDialog, {\n        title: title,\n        content: \"Silahkan login menggunakan akun google anda untuk melanjutkan transaksi ini.\" // cancelText=\"Lanjutkan tanpa login\"\n        ,\n        confirmText: \"Login\" // onCancel={() => localStorage.removeItem('token')}\n        ,\n        onConfirm: () => Router.push({\n          pathname: '/login',\n          query: {\n            ref: `/detail-tagihan/${this.state.orderId}`\n          }\n        }),\n        open: true,\n        mode: \"vertical\",\n        block: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 9\n        }\n      });\n    }\n\n    return __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 7\n      }\n    }, __jsx(MainLogo, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }\n    }), isLoading ? __jsx(CircularProgress, {\n      style: {\n        position: 'absolute',\n        left: '47%',\n        top: '50%'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 11\n      }\n    }) : __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 11\n      }\n    }, __jsx(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 13\n      }\n    }, \"Terjadi masalah ketika mengambil tagihan\"), __jsx(ButtonMain, {\n      color: \"primary\",\n      size: \"small\",\n      onClick: () => Router.push('/'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 13\n      }\n    }, \"Ke beranda\")), dialogLogin);\n  }\n\n}\nexport default DetailTagihan;","map":{"version":3,"sources":["/Users/otnielvictoryfa/task2020/atur-tagihan/pages/detail-tagihan/[order_id]/index.js"],"names":["React","Component","axios","Router","CircularProgress","MainLogo","getHashUrl","ButtonMain","isNotUndefined","isUserLoggedValid","CustomDialog","DetailTagihan","constructor","props","state","isLoading","componentDidMount","document","body","className","orderId","setState","login","inquiry","componentWillUnmount","hash","showSnackbar","BASE_URL","process","env","NEXT_PUBLIC_API_BASE_URL","url","headers","Authorization","JSON","parse","localStorage","getItem","access_token","data","stringify","order_identifier","post","then","apiResponse","response","result","code","is_processed","push","history","replaceState","title","router","replace","catch","error","user_errors","toString","render","dialogLogin","pathname","query","ref","position","left","top"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport Router from 'next/router';\n// material\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\n// component\nimport MainLogo from '../../../components/global-component/MainLogo';\nimport { getHashUrl } from '../../../utils/CommonUtils';\nimport ButtonMain from '../../../components/global-component/ButtonMain';\n\n// redux\nimport { isNotUndefined } from '../../../utils/Validator';\nimport { isUserLoggedValid } from '../../../utils/NetworkCall';\nimport CustomDialog from '../../../components/global-component/CustomDialog';\n\nexport class DetailTagihan extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n    };\n  }\n\n  async componentDidMount() {\n    document.body.className = 'body-blue';\n    const orderId = getHashUrl();\n    this.setState({ login: await isUserLoggedValid() });\n\n    if (this.state.login === 'logged') {\n      this.inquiry(orderId);\n    }\n  }\n\n  componentWillUnmount() {\n    document.body.className = null;\n  }\n\n  /**\n   * @method Inquiry\n   * @summary do inquiry of bayartagihan product\n   * @param hash\n   * @returns {Promise<void>}\n   * @note gak pake helper karena banyak kondisi\n   */\n  async inquiry(hash) {\n    const { showSnackbar } = this.props;\n\n    const BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL;\n    const url = `${BASE_URL}/inquiry/atur_tagihan`;\n    const headers = {\n      'Content-Type': 'application/json',\n      Authorization: `Bearer ${JSON.parse(localStorage.getItem('token')).access_token}`,\n    };\n    const data = JSON.stringify({\n      order_identifier: hash,\n    });\n\n    await axios\n      .post(url, data, { headers })\n      .then(async (apiResponse) => {\n        const { response, result } = apiResponse.data;\n        if (response.code !== '000000') {\n          showSnackbar('Terjadi Gangguan', 'error');\n          this.setState({ isLoading: false });\n        } else if (result.is_processed === 1) {\n          Router.push(`/status-pembayaran/${hash}`);\n          this.setState({ isLoading: false });\n        } else {\n          this.history.replaceState({}, document.title, url);\n          this.props.router.replace('/keranjang');\n          //Router.push('/keranjang');\n        }\n      }).catch((error) => {\n        if (isNotUndefined(error.response)) {\n          const { data } = error.response;\n          if (data.response.code === '000007') {\n            Router.push('/url-not-found');\n          }\n          // payment by b2b\n          else if (data.response.code === '000008') {\n            Router.push('/pembayaran-berhasil');\n          } else if (data.response.code === '000009') {\n            Router.push('/expired-bill');\n          }\n          showSnackbar(data.response.user_errors, 'error');\n        } else {\n          showSnackbar(error.toString(), 'error');\n        }\n        this.setState({ isLoading: false });\n      });\n  }\n\n  render() {\n    const { isLoading, login } = this.state;\n\n    let dialogLogin;\n    if (login === 'empty' || login === 'expired' || login === 'inactive') {\n      let title;\n      switch (login) {\n        case 'expired':\n          title = 'Sesi Anda Telah Habis';\n          break;\n        case 'inactive':\n          title = 'Akun Anda Tidak Aktif atau Terblokir';\n          break;\n        default:\n          title = 'Pemberitahuan';\n      }\n      dialogLogin = (\n        <CustomDialog\n          title={title}\n          content=\"Silahkan login menggunakan akun google anda untuk melanjutkan transaksi ini.\"\n          // cancelText=\"Lanjutkan tanpa login\"\n          confirmText=\"Login\"\n          // onCancel={() => localStorage.removeItem('token')}\n          onConfirm={() => Router.push({ pathname: '/login', query: { ref: `/detail-tagihan/${this.state.orderId}` } })}\n          open\n          mode=\"vertical\"\n          block\n        />\n      );\n    }\n\n    return (\n      <div>\n        <MainLogo />\n        {isLoading ? (\n          <CircularProgress style={{ position: 'absolute', left: '47%', top: '50%' }} />\n        ) : (\n          <div>\n            <p>Terjadi masalah ketika mengambil tagihan</p>\n            <ButtonMain color=\"primary\" size=\"small\" onClick={() => Router.push('/')}>Ke beranda</ButtonMain>\n          </div>\n        )}\n        {dialogLogin}\n      </div>\n    );\n  }\n}\n\nexport default (DetailTagihan);\n"]},"metadata":{},"sourceType":"module"}