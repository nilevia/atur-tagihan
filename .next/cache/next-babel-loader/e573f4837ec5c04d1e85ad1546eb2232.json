{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport Router from 'next/router'; // material\n\nimport CircularProgress from '@material-ui/core/CircularProgress'; // component\n\nimport { connect } from 'react-redux';\nimport MainLogo from '../../../components/global-component/MainLogo';\nimport { getHashUrl } from '../../../utils/CommonUtils'; // redux\n\nimport { showSnackbar } from '../../../redux/snackbar/action';\nimport { isNotUndefined } from '../../../utils/Validator';\nimport { isUserLoggedValid } from '../../../utils/NetworkCall';\nimport CustomDialog from '../../../components/global-component/CustomDialog';\nexport class DetailTagihan extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true\n    };\n  }\n\n  async componentDidMount() {\n    document.body.className = 'body-blue';\n    const orderId = getHashUrl();\n    this.setState({\n      orderId\n    });\n    this.setState({\n      login: await isUserLoggedValid()\n    });\n\n    if (this.state.login === 'logged') {\n      this.inquiry(orderId);\n    }\n  }\n\n  componentWillUnmount() {\n    document.body.className = null;\n  }\n  /**\n   * @method Inquiry\n   * @summary do inquiry of bayartagihan product\n   * @param hash\n   * @returns {Promise<void>}\n   * @note gak pake helper karena banyak kondisi\n   */\n\n\n  async inquiry(hash) {\n    const {\n      showSnackbar\n    } = this.props;\n    const BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL;\n    const url = `${BASE_URL}/inquiry/atur_tagihan`;\n    const headers = {\n      'Content-Type': 'application/json',\n      Authorization: `Bearer ${JSON.parse(localStorage.getItem('token')).access_token}`\n    };\n    const data = JSON.stringify({\n      order_identifier: hash\n    });\n    await axios.post(url, data, {\n      headers\n    }).then(async apiResponse => {\n      const {\n        response,\n        result\n      } = apiResponse.data;\n\n      if (response.code !== '000000') {\n        showSnackbar('Terjadi Gangguan', 'error');\n        this.setState({\n          isLoading: false\n        });\n      } else if (result.is_processed === 1) {\n        Router.push(`/status-pembayaran/${hash}`);\n        this.setState({\n          isLoading: false\n        });\n      } else {\n        Router.replace('/keranjang');\n      }\n    }).catch(error => {\n      if (isNotUndefined(error.response)) {\n        const {\n          data\n        } = error.response;\n\n        if (data.response.code === '000007') {\n          Router.push('/url-not-found');\n        } // payment by b2b\n        else if (data.response.code === '000008') {\n            Router.push('/pembayaran-berhasil');\n          } else if (data.response.code === '000009') {\n            Router.push('/expired-bill');\n          }\n\n        showSnackbar(data.response.user_errors, 'error');\n      } else {\n        showSnackbar(error.toString(), 'error');\n      }\n\n      this.setState({\n        isLoading: false\n      });\n    });\n  }\n\n  render() {\n    const {\n      isLoading,\n      login\n    } = this.state;\n    let dialogLogin;\n\n    if (login === 'empty' || login === 'expired' || login === 'inactive') {\n      let title;\n\n      switch (login) {\n        case 'expired':\n          title = 'Sesi Anda Telah Habis';\n          break;\n\n        case 'inactive':\n          title = 'Akun Anda Tidak Aktif atau Terblokir';\n          break;\n\n        default:\n          title = 'Pemberitahuan';\n      }\n\n      dialogLogin = __jsx(CustomDialog, {\n        title: title,\n        content: \"Silahkan login menggunakan akun google anda untuk melanjutkan transaksi ini.\" // cancelText=\"Lanjutkan tanpa login\"\n        ,\n        confirmText: \"Login\" // onCancel={() => localStorage.removeItem('token')}\n        ,\n        onConfirm: () => Router.push({\n          pathname: '/login',\n          query: {\n            ref: `/detail-tagihan/${this.state.orderId}`\n          }\n        }),\n        open: true,\n        mode: \"vertical\",\n        block: true\n      });\n    }\n\n    return __jsx(\"div\", null, __jsx(MainLogo, null), isLoading ? __jsx(CircularProgress, {\n      style: {\n        position: 'absolute',\n        left: '47%',\n        top: '50%'\n      }\n    }) : null, dialogLogin);\n  }\n\n}\nconst mapDispatchToProps = {\n  showSnackbar\n};\nexport default connect(null, mapDispatchToProps)(DetailTagihan);","map":null,"metadata":{},"sourceType":"module"}